(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const g of n.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&l(g)}).observe(document,{childList:!0,subtree:!0});function o(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(s){if(s.ep)return;s.ep=!0;const n=o(s);fetch(s.href,n)}})();const c=t=>{if(typeof t=="string")return document.createTextNode(t);const e=document.createElement(t.tag);t.attrs&&Object.entries(t.attrs).forEach(([l,s])=>{l.startsWith("on")&&typeof s=="function"?e.addEventListener(l.substring(2).toLowerCase(),s):e.setAttribute(l,s)});const o=document.createDocumentFragment();return(t.children||[]).forEach(l=>o.appendChild(c(l))),e.appendChild(o),e};function p(t,e){t instanceof HTMLElement?e.appendChild(t):e.appendChild(c(t))}function b(t){if(t instanceof HTMLElement)t.innerHTML="";else throw new Error("Invalid vdom type. Expected an HTMLElement.")}function a(t){if(t instanceof HTMLElement)return t;if(typeof t=="string")return document.querySelector(t);throw new Error("Invalid node type. Expected an HTMLElement or a string.")}function v(t,e){if(t instanceof HTMLElement)t.innerHTML=e;else throw new Error("Invalid node type. Expected an HTMLElement or a string.")}let i={todos:[],filter:"all"};function u(t){i={...i,...t}}function r(){return i}function M(){switch(console.log("filterTodos:",i.filter),i.filter){case"active":return i.todos.filter(t=>!t.isCompleted);case"completed":return i.todos.filter(t=>t.isCompleted);default:return i.todos}}const f={};function m(t,e,o){f[t]||(f[t]={}),f[t][e]||(f[t][e]=[]),f[t][e].push(o),console.log("events:",f),t.addEventListener(e,o)}const N=t=>{let e=r().todos.filter(o=>o.id!==t);u({todos:e})},k=t=>{let e=r().todos.map(o=>o.id===t?{...o,isCompleted:!o.isCompleted}:o);u({todos:e})},x=t=>{let e=r().todos.map(o=>({...o,isCompleted:t}));u({todos:e})},H=(t,e)=>{let o=r().todos.map(l=>l.id===t?{...l,text:e}:l);u({todos:o})};function O(){let t=r().todos.filter(e=>!e.isCompleted);u({todos:t})}const A=t=>{console.log("CREATE NODE IS CALLED");let e=t.isCompleted?"completed":"";const o=c({tag:"li",attrs:{class:e}}),l=c({tag:"div",attrs:{class:"view"},children:[{tag:"input",attrs:{class:"toggle",type:"checkbox",...t.isCompleted?{checked:!0}:{},onclick:()=>{k(t.id),console.log("toggle todo:",r().todos),d()}}},{tag:"label",children:[t.text]},{tag:"button",attrs:{class:"destroy",onclick:()=>{N(t.id),console.log("remove todo:",r().todos),d()}}}]});p(l,o);const s=c({tag:"input",attrs:{class:"edit",value:t.text}});return p(s,o),m(l.children[1],"dblclick",()=>{o.classList.add("editing"),s.focus()}),m(s,"keyup",n=>{if(n.key==="Enter"){let g=n.target.value;H(t.id,g),console.log("update todo: ",r().todos),d()}else n.key==="Escape"&&(n.target.value=t.text,o.classList.remove("editing"))}),m(s,"blur",n=>{n.target.value=t.text,o.classList.remove("editing")}),o};function d(){const t=a(".todo-list");b(t),M().forEach(o=>{const l=A(o);p(l,t)}),C()}let E={};function I(t){E={...t,"/404":()=>{console.error("No route found"),document.body.innerHTML="<h1>404 - Page Not Found</h1>"}},window.addEventListener("popstate",T),T()}const T=()=>{let t=window.location.pathname;const e=E[t]||E["/404"];e?(console.log(`Navigating to: ${t}`),e(t)):console.error(`No route found for: ${t}`)};function h(t){history.pushState({},"",t),T()}const S=a("#app");let L,w;function D(){const t=c({tag:"section",attrs:{class:"todoapp"},children:[{tag:"header",attrs:{class:"header"},children:[{tag:"h1",children:["todoMVC"]},{tag:"input",attrs:{class:"new-todo",placeholder:"What needs to be done?",autofocus:!0}}]}]});p(t,S),L=c({tag:"section",attrs:{class:"main"},children:[{tag:"input",attrs:{id:"toggle-all",class:"toggle-all",type:"checkbox",onclick:e=>{x(e.target.checked),d()}}},{tag:"label",attrs:{for:"toggle-all"},children:["Mark all as complete"]},{tag:"ul",attrs:{class:"todo-list"}}]}),p(L,t),w=c({tag:"footer",attrs:{class:"footer"},children:[{tag:"span",attrs:{class:"todo-count"},children:["0 items left"]},{tag:"ul",attrs:{class:"filters"},children:[{tag:"li",attrs:{filter:"all",onclick:()=>h("/")},children:[{tag:"a",children:["All"]}]},{tag:"li",attrs:{filter:"active",onclick:()=>h("/active")},children:[{tag:"a",children:["Active"]}]},{tag:"li",attrs:{filter:"completed",onclick:()=>h("/completed")},children:[{tag:"a",children:["Completed"]}]}]},{tag:"button",attrs:{class:"clear-completed",onclick:()=>{O(),d()}},children:["Clear completed"]}]}),p(w,t),C()}function C(){let t=r().todos;L.style.display=w.style.display=t.length>0?"block":"none",a(".clear-completed").style.display=t.some(s=>s.isCompleted)?"block":"none";const e=t.filter(s=>!s.isCompleted).length,o=a(".todo-count");v(o,`<strong>${e}</strong> item${e===1?"":"s"} left`);let l=r().filter;console.log("filter",l),a(".filters").querySelectorAll("a").forEach(s=>s.classList.remove("selected")),a(`.filters [filter="${l}"] a`).classList.add("selected")}D();const P=t=>{const o=[{id:crypto.randomUUID(),text:t,isCompleted:!1},...r().todos];return u({todos:o}),o},$=()=>{const t=a(".new-todo");m(t,"keyup",e=>{e.key==="Enter"&&e.target.value.trim()!==""&&(P(e.target.value),d(),e.target.value="")})},y=t=>{console.log("route: ",t),u({filter:t}),d()};I({"/":()=>y("all"),"/active":()=>y("active"),"/completed":()=>y("completed")});$();
