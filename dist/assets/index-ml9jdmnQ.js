(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const g of r.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&n(g)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();const a=t=>{if(typeof t=="string")return document.createTextNode(t);const e=document.createElement(t.tag);t.attrs&&Object.entries(t.attrs).forEach(([n,s])=>{n.startsWith("on")&&typeof s=="function"?e.addEventListener(n.substring(2).toLowerCase(),s):e.setAttribute(n,s)});const o=document.createDocumentFragment();return(t.children||[]).forEach(n=>o.appendChild(a(n))),e.appendChild(o),e};function p(t,e){t instanceof HTMLElement?e.appendChild(t):e.appendChild(a(t))}function v(t){if(t instanceof HTMLElement)t.innerHTML="";else throw new Error("Invalid vdom type. Expected an HTMLElement.")}function c(t){if(t instanceof HTMLElement)return t;if(typeof t=="string")return document.querySelector(t);throw new Error("Invalid node type. Expected an HTMLElement or a string.")}function k(t,e){if(t instanceof HTMLElement)t.innerHTML=e;else throw new Error("Invalid node type. Expected an HTMLElement or a string.")}let i={todos:[],filter:"all"};function u(t){i={...i,...t}}function l(){return i}function M(){switch(console.log("filterTodos:",i.filter),i.filter){case"active":return i.todos.filter(t=>!t.isCompleted);case"completed":return i.todos.filter(t=>t.isCompleted);default:return i.todos}}const f={};function h(t,e,o){f[t]||(f[t]={}),f[t][e]||(f[t][e]=[]),f[t][e].push(o),console.log("events:",f),t.addEventListener(e,o)}const N=t=>{let e=l().todos.filter(o=>o.id!==t);u({todos:e})},x=t=>{let e=l().todos.map(o=>o.id===t?{...o,isCompleted:!o.isCompleted}:o);u({todos:e})},H=t=>{let e=l().todos.map(o=>({...o,isCompleted:t}));u({todos:e})},O=(t,e)=>{let o=l().todos.map(n=>n.id===t?{...n,text:e}:n);u({todos:o})};function A(){let t=l().todos.filter(e=>!e.isCompleted);u({todos:t})}const I=t=>{console.log("CREATE NODE IS CALLED");let e=t.isCompleted?"completed":"";const o=a({tag:"li",attrs:{class:e}}),n=a({tag:"div",attrs:{class:"view"},children:[{tag:"input",attrs:{class:"toggle",type:"checkbox",...t.isCompleted?{checked:!0}:{},onclick:()=>{x(t.id),console.log("toggle todo:",l().todos),d()}}},{tag:"label",children:[t.text]},{tag:"button",attrs:{class:"destroy",onclick:()=>{N(t.id),console.log("remove todo:",l().todos),d()}}}]});p(n,o);const s=a({tag:"input",attrs:{class:"edit",value:t.text}});return p(s,o),h(n.children[1],"dblclick",()=>{o.classList.add("editing"),s.focus()}),h(s,"keyup",r=>{if(r.key==="Enter"){let g=r.target.value;O(t.id,g),console.log("update todo: ",l().todos),d()}else r.key==="Escape"&&(r.target.value=t.text,o.classList.remove("editing"))}),h(s,"blur",r=>{r.target.value=t.text,o.classList.remove("editing")}),o};function d(){const t=c(".todo-list");v(t),M().forEach(o=>{const n=I(o);p(n,t)}),b()}let T={},m="";function P(t){T={...t,"/404":()=>{console.error("No route found"),document.body.innerHTML="<h1>404 - Page Not Found</h1>"}},window.location.pathname.includes("/mini-js-framework")&&(m="/mini-js-framework"),window.addEventListener("popstate",w),w()}const w=()=>{let t=window.location.pathname;m&&t.startsWith(m)&&(t=t.substring(m.length)||"/");const e=T[t]||T["/404"];e?(console.log(`Navigating to: ${t}`),e(t)):console.error(`No route found for: ${t}`)};function y(t){const e=m+t;history.pushState({},"",e),w()}const S=c("#app");let L,C;function D(){const t=a({tag:"section",attrs:{class:"todoapp"},children:[{tag:"header",attrs:{class:"header"},children:[{tag:"h1",children:["todoMVC"]},{tag:"input",attrs:{class:"new-todo",placeholder:"What needs to be done?",autofocus:!0}}]}]});p(t,S),L=a({tag:"section",attrs:{class:"main"},children:[{tag:"input",attrs:{id:"toggle-all",class:"toggle-all",type:"checkbox",onclick:e=>{H(e.target.checked),d()}}},{tag:"label",attrs:{for:"toggle-all"},children:["Mark all as complete"]},{tag:"ul",attrs:{class:"todo-list"}}]}),p(L,t),C=a({tag:"footer",attrs:{class:"footer"},children:[{tag:"span",attrs:{class:"todo-count"},children:["0 items left"]},{tag:"ul",attrs:{class:"filters"},children:[{tag:"li",attrs:{filter:"all",onclick:()=>y("/")},children:[{tag:"a",children:["All"]}]},{tag:"li",attrs:{filter:"active",onclick:()=>y("/active")},children:[{tag:"a",children:["Active"]}]},{tag:"li",attrs:{filter:"completed",onclick:()=>y("/completed")},children:[{tag:"a",children:["Completed"]}]}]},{tag:"button",attrs:{class:"clear-completed",onclick:()=>{A(),d()}},children:["Clear completed"]}]}),p(C,t),b()}function b(){let t=l().todos;L.style.display=C.style.display=t.length>0?"block":"none",c(".clear-completed").style.display=t.some(s=>s.isCompleted)?"block":"none";const e=t.filter(s=>!s.isCompleted).length,o=c(".todo-count");k(o,`<strong>${e}</strong> item${e===1?"":"s"} left`);let n=l().filter;console.log("filter",n),c(".filters").querySelectorAll("a").forEach(s=>s.classList.remove("selected")),c(`.filters [filter="${n}"] a`).classList.add("selected")}D();const $=t=>{const o=[{id:crypto.randomUUID(),text:t,isCompleted:!1},...l().todos];return u({todos:o}),o},R=()=>{const t=c(".new-todo");h(t,"keyup",e=>{e.key==="Enter"&&e.target.value.trim()!==""&&($(e.target.value),d(),e.target.value="")})},E=t=>{console.log("route: ",t),u({filter:t}),d()};P({"/":()=>E("all"),"/active":()=>E("active"),"/completed":()=>E("completed")});R();
